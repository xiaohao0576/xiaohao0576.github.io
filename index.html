<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hogan Blog </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.64.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.1cb140d8ba31d5b2f1114537dd04802a.css" rel="stylesheet">
    

    

    
      
    

    
    
      <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Hogan Blog" />
      <link href="/index.xml" rel="feed" type="application/rss+xml" title="Hogan Blog" />
      
    
    
    <meta property="og:title" content="Hogan Blog" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://xiaohao0576.github.io/" />
<meta property="og:updated_time" content="2020-04-10T14:25:42+07:00" />
<meta itemprop="name" content="Hogan Blog">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hogan Blog"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://xiaohao0576.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Hogan Blog
    </a>
    <div class="flex-l items-center">
      

      
      














    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          Hogan Blog
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray">
    
  </article>
  
  
  
  
  
  
  
    
    

    <div class="pa3 pa4-ns w-100 w-70-ns center">
      
       
          <h1 class="flex-none">
            Recent Posts
          </h1>
        

      

      <section class="w-100 mw8">
        
        
          <div class="relative w-100 mb4">
            
<article class="bb b--black-10">
  <div class="db pv4 ph3 ph0-l no-underline dark-gray">
    <div class="flex flex-column flex-row-ns">
      
      <div class="blah w-100">
        <h1 class="f3 fw1 athelas mt0 lh-title">
          <a href="https://xiaohao0576.github.io/posts/hr-salary-working-days/" class="color-inherit dim link">
            Hr Salary Working Days
            </a>
        </h1>
        <div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
          Salary rule中计算员工每天的薪资 问题描述 公司计算员工无薪假应扣除的薪资时，需要先计算每天的薪资，大概有以下几种算法:
 员工的工资 / 当月天数 （按日历表上计算） 员工的工资 / 当月上班的天数 （去除周末，但包含公共节假日） 员工的工资 / 当月实际应该出勤的天数 （去除周末和节假日） 但无论哪种算法，在salary rule中的python code中都无法直接获取当月应该上班的天数或小时数。  解决思路  二次开发 快速粗暴的方法  先说二次开发的方法 salary rule中的python code部分，能够引用的对象是有限制的，这是因为代码是在Odoo的safe_eval方法中运行的，只看方法名就应该能想到会有很多限制。如果想深入了解代码运行原理，可以去查看hr.payslip的代码，里面有一个_get_payslip_lines()方法，方法中的localdict字典包含了在salary rule中可以引用的对象。
由于本人刚接触Odoo不久，不知道如何二次开发，所以这个方法留以后研究。
再说快速粗暴的方法 直接离线算出每月应该工作的天数和小时数，然后硬编码到salary rule中。此方法适用的条件如下：
 全公司只遵循一种上班时间制度，如果不同的员工有不同的上班时间安排，则不太适用此方法 公司不会频繁改变上班时间安排  上代码 from pytz import timezone from datetime import datetime def get_work_days_data(employee, years=(2020, 2021, 2022)): &#34;&#34;&#34;获取指定员工的工作日期和时间,如果需要获取满勤的工作天数和时长Args:employee: hr.employee对象years:获取哪几年的工作天数,元组或列表&#34;&#34;&#34; tz=timezone(employee.tz) working_days = {} for year in years: month_data = [] for month in range(1, 13): date_from = datetime(year, month, 1) if month &lt; 12: date_to = datetime(year, month+1, 1) else: date_to = datetime(year+1, 1, 1) data = employee.
        </div>
          <a href="https://xiaohao0576.github.io/posts/hr-salary-working-days/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
        
      </div>
    </div>
  </div>
</article>

          </div>
        
          <div class="relative w-100 mb4">
            
<article class="bb b--black-10">
  <div class="db pv4 ph3 ph0-l no-underline dark-gray">
    <div class="flex flex-column flex-row-ns">
      
      <div class="blah w-100">
        <h1 class="f3 fw1 athelas mt0 lh-title">
          <a href="https://xiaohao0576.github.io/posts/my-first-post/" class="color-inherit dim link">
            My First Post
            </a>
        </h1>
        <div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
          这是第一篇Hugo日志 今天使用Hugo和Github Pages搭建了博客，希望以后自己经常更新。
        </div>
          <a href="https://xiaohao0576.github.io/posts/my-first-post/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
        
      </div>
    </div>
  </div>
</article>

          </div>
        
      </section>

      

      </div>
  

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://xiaohao0576.github.io/" >
    &copy;  Hogan Blog 2020 
  </a>
    <div>













</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
